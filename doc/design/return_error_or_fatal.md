# 返回 error 还是原地 fatal

哪种好呢？在一个纯命令行应用中，及时 fatal，并能在 panic 中打印出堆栈对调试即为有益。

若是返回 error，虽然看起来：

1. 对每种异常处理都定义的很清楚（有明确的错误消息）
2. 写单测也更容易

如果函数调用嵌套很深，导致 error 被一层层包裹返回，以至于在最上层拿到 error 时你都分不清到底出错点在哪 -_-，虽然 Go 1.13 的 error wrap 一定程度消减了这个问题，但还是不如 panic 来的好调试。（如果是一个 web 应用，则做法相反，web 的查错主要靠详细的日志，这时候不应鼓励过多的 panic 或 os.Exit(1))

而且 goc 并不是一个供大家使用的库，很多 error 没必要往上抛。

目前来看 fatal 还是更适合。

那如何保障测试质量呢？我们不应被覆盖率所绑架，只要测试用例全面，一样可以保证质量。